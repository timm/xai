<!DOCTYPE html>

<html>
<head>
  <title>tmp.lua</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>tmp.lua</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-1">&#x00a7;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">local</span> _ = <span class="hljs-built_in">require</span><span class="hljs-string">&quot;lib&quot;</span>
<span class="hljs-keyword">local</span> any,big,cat,chat,cli,coerce    = _.any,_.big,_.cat,_.chat,_.cli,_.coerce
<span class="hljs-keyword">local</span> csv,fmt,get,gt                 = _.csv,_.fmt,_.get,_.gt
<span class="hljs-keyword">local</span> klass,<span class="hljs-built_in">lines</span>,lt,main,many,map   = _.klass,_.<span class="hljs-built_in">lines</span>,_.lt,_.main,_.many,_.map
<span class="hljs-keyword">local</span> obj,per,push,rand,rev,rnd      = _.obj,_.per,_.push,_.rand,_.rev,_.rnd
<span class="hljs-keyword">local</span> rogues,same,shuffle,slice,<span class="hljs-built_in">sort</span> = _.rogues,_.same,_.shuffle,_.slice,_.<span class="hljs-built_in">sort</span>
<span class="hljs-keyword">local</span> values,words                   = _.values,_.words

<span class="hljs-keyword">local</span> _ = <span class="hljs-built_in">require</span><span class="hljs-string">&quot;xai&quot;</span>
<span class="hljs-keyword">local</span> the, help,csv2data =  _.the, _.help, _.csv2data
<span class="hljs-keyword">local</span> ABOUT,DATA,NOM     = _.ABOUT, _.DATA,_.NOM
<span class="hljs-keyword">local</span> RATIO,ROW,XY       = _.RATIO,_.ROW,_.XY
<span class="hljs-keyword">local</span> bins,half,how      = _.bins, _.half, _.how</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-2">&#x00a7;</a>
              </div>
              <h2 id="tests">Tests</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-3">&#x00a7;</a>
              </div>
              <p>Tests fail if they do not return <code>true</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">local</span> go={}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.pass</span><span class="hljs-params">()</span></span> <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.the</span><span class="hljs-params">()</span></span> chat(the); <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.nom</span><span class="hljs-params">(   nom)</span></span>
  nom=NOM()
  <span class="hljs-keyword">for</span> i=<span class="hljs-number">1</span>,<span class="hljs-number">1</span> <span class="hljs-keyword">do</span> 
    <span class="hljs-keyword">for</span> _,x <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>{<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>} <span class="hljs-keyword">do</span>
      nom:add(x) <span class="hljs-keyword">end</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;a&quot;</span>==nom:mid() <span class="hljs-keyword">and</span> <span class="hljs-number">1.38</span>==rnd(nom:div(),<span class="hljs-number">2</span>) <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.ratio</span><span class="hljs-params">(    r)</span></span>
  r=RATIO()
  the.ratios = <span class="hljs-number">64</span>
  <span class="hljs-keyword">for</span> i=<span class="hljs-number">1</span>,<span class="hljs-number">100</span> <span class="hljs-keyword">do</span> r:add(i) <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">52</span>==r:mid() <span class="hljs-keyword">and</span> <span class="hljs-number">32.56</span>==rnd(r:div(),<span class="hljs-number">2</span>)  <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.about</span><span class="hljs-params">()</span></span>
  map(  ABOUT{<span class="hljs-string">&quot;Clndrs&quot;</span>,<span class="hljs-string">&quot;Volume&quot;</span>,<span class="hljs-string">&quot;Hp:&quot;</span>,<span class="hljs-string">&quot;Lbs-&quot;</span>,
          <span class="hljs-string">&quot;Acc+&quot;</span>,<span class="hljs-string">&quot;Model&quot;</span>,<span class="hljs-string">&quot;origin&quot;</span>,<span class="hljs-string">&quot;Mpg+&quot;</span>}.y , chat)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.one</span><span class="hljs-params">(     data1,data2)</span></span>
  data1=csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mid1&quot;</span>, cat(data1:mid(<span class="hljs-number">2</span>)))
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;div1&quot;</span>, cat(data1:div(<span class="hljs-number">2</span>)))
  data2=            data1:clone(data1.rows)
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;mid2&quot;</span>, cat(data2:mid(<span class="hljs-number">2</span>)))
  <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;div2&quot;</span>, cat(data2:div(<span class="hljs-number">2</span>)))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.dist</span><span class="hljs-params">(    data,row1,row2)</span></span>
  data= csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  <span class="hljs-built_in">print</span>(#data.rows)
  <span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>,<span class="hljs-number">20</span> <span class="hljs-keyword">do</span>
    row1=any(data.rows)
    row2=any(data.rows)
    <span class="hljs-built_in">print</span>(row1-row2) <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.betters</span><span class="hljs-params">(   data,data1,data2)</span></span>
  data= csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  data.rows = <span class="hljs-built_in">sort</span>(data.rows) 
  data1=data:clone(slice(data.rows,<span class="hljs-number">1</span>,<span class="hljs-number">50</span>))
  data2=data:clone(slice(data.rows,(#data.rows)<span class="hljs-number">-50</span>))
  map({data1:mid(), data2:mid()},chat)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.half</span><span class="hljs-params">(   data)</span></span>
  data= csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  <span class="hljs-keyword">local</span> As,Bs,_= half.splits(data.rows)
  <span class="hljs-built_in">print</span>(#As,#Bs)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.bestOrRest</span><span class="hljs-params">(   data,data1,data2,best,rest0,rest)</span></span>
  data= csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  best,rest0 = bestOrRest(data.rows)
  rest = many(rest0, #best*<span class="hljs-number">4</span>)
  data1=clone(data, best)
  data2=clone(data, rest)
  map({stats(data1),stats(data2)},chat) 
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.bins</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">local</span> data= csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>)
  <span class="hljs-keyword">local</span> best,rest0 = half.splits(data.rows)
  <span class="hljs-keyword">local</span> rest = many(rest0, #best*<span class="hljs-number">2</span>*the.Balance)
  <span class="hljs-keyword">local</span> rows ={}
  <span class="hljs-keyword">for</span> _,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(rest) <span class="hljs-keyword">do</span> push(rows,row).label=<span class="hljs-string">&quot;rest&quot;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">for</span> _,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(best) <span class="hljs-keyword">do</span> push(rows,row).label=<span class="hljs-string">&quot;best&quot;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">for</span> _,col <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(data.about.x) <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>)
    map(bins.<span class="hljs-built_in">find</span>(rows,col),
        <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(xy)</span></span> <span class="hljs-built_in">print</span>(xy.txt,xy.xlo,xy.xhi, cat(xy.y.has)) <span class="hljs-keyword">end</span>) <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span>

<span class="hljs-keyword">local</span> _ranked=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data)</span></span>
   <span class="hljs-keyword">for</span> n,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(<span class="hljs-built_in">sort</span>(data.rows)) <span class="hljs-keyword">do</span> row.rank= rnd(<span class="hljs-number">100</span>*n/#data.rows,<span class="hljs-number">0</span>); <span class="hljs-keyword">end</span>
   <span class="hljs-keyword">for</span> _,row <span class="hljs-keyword">in</span> <span class="hljs-built_in">pairs</span>(data.rows) <span class="hljs-keyword">do</span> row.evaled=<span class="hljs-literal">false</span> <span class="hljs-keyword">end</span>
   shuffle(data.rows)
   <span class="hljs-keyword">return</span> data  <span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">go.rules</span><span class="hljs-params">(      data)</span></span>
  <span class="hljs-keyword">local</span> data= _ranked(csv2data(<span class="hljs-string">&quot;../data/auto93.csv&quot;</span>))
  how.rules(data)
  chat(<span class="hljs-built_in">sort</span>(map(data.rows,get<span class="hljs-string">&quot;rank&quot;</span>)))
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="sswrap ">
                <a class="ss" href="#section-4">&#x00a7;</a>
              </div>
              <h2 id="start-up">Start-up</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>

main(help,the,go)</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
